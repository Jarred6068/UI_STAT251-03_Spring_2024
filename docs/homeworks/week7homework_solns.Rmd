---
title: "Homework 3 Solutions"
output:
  html_document: default
  pdf_document: default
always_allow_html: true
header-includes:
  \usepackage{float}
bibliography: C:/Users/Bruin/Documents/GitHub/UI_STAT251-03_Spring_2024/docs/misc/home2bibs.bib
---




```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=12, fig.height=10, fig.pos = "H")
#knitr::opts_chunk$set(list(echo = FALSE, eval = FALSE))
library(kableExtra)
library(knitr)
library(latex2exp)
library(gridExtra)
library(ggpubr)
library(ggthemes)
library(plyr)
mainpath = 'C:/Users/Bruin/Documents/GitHub/UI_STAT251-03_Spring_2024/docs/Data/'
wmpath = 'C:/Users/Bruin/Desktop/GS Academia/MS_Stat/SEM 2/STAT 519/PROJ 1/watermelon/simulated datasets/ wawamelon/WaterMelonMaster.csv'
whiskpath = 'C:/Users/Bruin/Desktop/GS Academia/MS_Stat/SEM 2/STAT 519/PROJ 1/Whiskers/SimSealData/whiskerMaster.csv'

datapath = 'C:/Users/Bruin/Documents/GitHub/UI_STAT251-03_Spring_2024/docs/Data/'
#<span style="color: red;"></span>
```


### Definitions
Define the following terms/concepts

* a.) Sampling Error - <span style="color: red;"></span>

* b.) Law of Large Numbers - <span style="color: red;"></span>

* c.) Sample Space - <span style="color: red;"></span>

* d.) Event - <span style="color: red;"></span>

* e.) Union - <span style="color: red;"></span>

* f.) Intersection - <span style="color: red;"></span>

* g.) Conditional Probability - <span style="color: red;"></span>

* h.) Random Trial - <span style="color: red;"></span>

* i.) Random Variable - <span style="color: red;"></span>

* j.) Probability distribution - <span style="color: red;"></span>

* k.) Population distribution - <span style="color: red;"></span>

* l.) Continuous random variable - <span style="color: red;">A random variable with an uncountable number of outcomes</span>

* m.) Discrete random variable - <span style="color: red;">A random variable with a countable number of outcomes</span>

* n.) Probability Mass Function - <span style="color: red;">A function which assigns a probability to each outcome of a discrete random variable</span>

* o.) Probability Density Function - <span style="color: red;">A function which assigns probability density to different outcomes of a continuous random variable</span>


## Simple probability

$\bf (1)$ A fair coin is thrown 3 times. What is the probability that <u>at least</u> one heads is observed? 

<span style="color: red;"></span>

$\bf (2)$ Suppose that in a class of 30 students, 8 students are in band, 15 students play a sport, and 5 students are both in band and play a sport. Let $A$ be the event that a student is in band and let $B$ be the event that a student plays a sport. Create a Venn diagram that models this situation. What is the probability that a student is in the band or plays a sport?

<span style="color: red;"></span>

$\bf (3)$ A standard deck of 52 cards contains four suits (Hearts, Diamonds, Clubs, and Spades). Each suit contains 13 cards (9 numbered cards and 3 face cards, and an Ace). 

* Suppose a single card is drawn at random, what is the probability that it is a numbered?
<span style="color: red;"></span>

* What is the probability of that the selected card is the Ace of Spades (assume independence)? 
<span style="color: red;"></span>

$\bf (4)$ An urn contains 5 green balls, 7 red balls, and 4 yellow balls. Two balls are selected at random with replacement. What is the probability that first ball is yellow and the second ball is red?

<span style="color: red;"></span>

$\bf (5)$ The probability that it rains $R$ on a given day in Moscow, Idaho is $P(R) = 0.1$. The probability that it is Windy $W$ is $P(W) = 0.2$, and the probability that it is cloudy $C$ is $P(C) = 0.7$. Assume that these three types of weather events are independent. What is the probability that a given day is both Rainy, Cloudy, and Windy?

<span style="color: red;"></span>

## Sampling Distributions, Means, and Variances

$\bf (6)$ A random variable $X$ has the following probability distribution

```{r, echo=FALSE, warning=F, message=F}

df = cbind.data.frame(X = c(1,2,3,4),
                      `P(X)` = c(0.25, 0.25, 0.25, 0.25))

kable(df, format = 'html', digits = 2, row.names = F, booktabs = T, escape = F)%>%
  kable_classic(full_width = F, html_font = "Cambria")%>%kable_styling(bootstrap_options = 'striped')

```

* Derive the sampling distribution for the mean of $n=2$ observations of $X$
```{}
```

* Compute the population mean $\mu$ and population standard deviation $\sigma$ of $X$
<span style="color: red;"></span>

$\bf (7)$ A random variable $Y$ has two possible outcomes. The outcome $Y = 1$ occurs with probability $p = 0.23$. Derive the sampling distribution for the proportion of outcomes with $Y = 1$ in a sample of $n = 3$ observations of $Y$.

```{}

```


$\bf (8)$ Consider a survey of tree volume. Suppose that in the population of trees $10\%$ have a volume of 10 cubic feet, $20\%$ have a volume of 20 cubic feet, $30\%$ have a volume of 30 cubic feet, and $40\%$ have a volume of 40 cubic feet. Let $X$ denote the volume of a randomly selected tree, assuming that every tree has an equal chance of being selected. The probability distribution of $X$ is given in the table below.


```{r, echo=FALSE, warning=F, message=F}

df = cbind.data.frame(X = c(10,20,30,40),
                      `P(X)` = c(0.1, 0.2, 0.3, 0.4))

kable(df, format = 'html', digits = 2, row.names = F, booktabs = T, escape = F)%>%
  kable_classic(full_width = F, html_font = "Cambria")%>%kable_styling(bootstrap_options = 'striped')

```

* Confirm that $X$ has a mean of $\mu = 30$ cubic feet and a standard deviation of $\sigma = 10$ cubic
feet by computing them yourself.

<span style="color: red;"></span>

* Derive the sampling distribution for the mean tree volume in a sample of $n = 2$ trees.
```{}
```

## Deriving Probabilities From Discrete Distributions

$\bf (9)$ Michael Dickson, who plays for the Seattle Seahawks, is a punter in the NFL. The following sampling distribution gives the mean punting distance (in yards) for a sample of $n=4$ punts. Use this distribution to answer the following questions:

```{r, echo=FALSE, warning=F, message=F}

df = cbind.data.frame(`$\\bar{X} =$ Mean Punt Distance` = c(35.33, 45.67, 55.00, 60.33, 65.67),
                      `$P(\\bar{X})$` = c(0.3, 0.5, 0.08, 0.01, 0.01))
kable(df, format = 'html', digits = 2, row.names = F, booktabs = T, escape = T)%>%
  kable_classic(full_width = F, html_font = "Cambria")%>%kable_styling(bootstrap_options = 'striped')

```

* What is the probability the mean distance is 55 or more yards?
<span style="color: red;"></span>

* What is the probability the mean distance is at least 35.33 yards?
<span style="color: red;"></span>

* What is the probability the mean distance is between 25 and 45.67 yards?
<span style="color: red;"></span>

* What is the probability the mean distance is 25 yards or 55 yards?
<span style="color: red;"></span>

$\bf (10)$ A random variable $X$ follows a binomial distribution with with probability of success $p = 0.43$ and number of trials $n = 8$. What is the probability of observing fewer than 3 success, that is what is $P(X \leq 3)$?

<span style="color: red;">Let $X \sim Binomial(p = 0.43, n = 8)$ then</span>

\[ \color{red}{P(X \leq 3) =  P(X = 0)+P(X = 1)+P(X = 2)+P(X = 3)}\]

\[ \color{red}{= \sum_{k = 0}^3 \frac{8!}{k!(8 - k)!} \times 0.43^{k} \times (1-0.43)^{8-k} = 0.534}\]

$\bf (11)$ Tom Brady is a famous quarterback who recently retired from playing in the National Football League. During his career, the probability that Brady would complete a pass in a given play was $64.3\%$.  If a typical NFL team runs about $35$ offensive pass plays, what is the probability that Brady would complete exactly $28$ pass plays in a game?

<span style="color: red;"> Let $X \sim Binomial(p = 0.643, n = 35)$ then

\[\color{red}{P(X = 28) = \frac{35!}{28!(35 - 28)!} \times 0.643^{28}\times (1-0.643)^{35-28} = 0.021}\] 

</span>


$\bf (12)$ A random variable $W$ follows a Poisson distribution with rate parameter $\lambda = 1.8$ events per hour. What is the probability of observing exactly four events in a given hour, that is what is $P(W = 4)$?

<br>

$\bf (13)$ A factory experiences on average 3 equipment malfunctions per day, following a Poisson distribution with a rate parameter of 3. Calculate the probability that on a randomly selected day, the factory will <u>observe 3 or more</u> equipment malfunctions.


## Deriving Probabilities From Continuous Distributions

${\bf (14)}$ Use the plot below of the probability distribution of a continuous random variable $X$ to answer the following questions

```{r, echo=F, message=F, warning=FALSE, fig.height=6, fig.width=10}
#C:/Users/Bruin/Desktop/GS Academia/TA/Teaching STAT 251/FALL/Week_5/PMFplot1.pdf}
h1 = round(1/6, 3)
#homework 4 plots
dist = cbind.data.frame(val = c(0,0, 0.3, 0.6, 0.9, 1.2, 1.5, 1.8, 2.1,2.1), 
                        dens = c(0,2*h1,4*h1,4*h1,5*h1,1*h1,1*h1,3*h1,1*h1,0))
#pdf(paste0(savepath, "PMFplot1.pdf"), height = 5, width = 6.5)
ggplot(data = dist, aes(x = val, y = dens))+geom_step(size = 1)+theme_pander()+
  scale_x_continuous(limits=c(0, 2.1), breaks = seq(0, 2.1, 0.3))+
  scale_y_continuous(limits=c(0,5*h1), 
                     breaks = seq(0, 5*h1, h1))+
  geom_segment(aes(xend = -1, x = 1, yend = 0, y = 0), size = 1, color = 'black')+
  theme(panel.grid.minor = element_blank(), axis.text = element_text(size = 12),
        axis.title = element_text(size = 14))+
  xlab('X')+
  ylab("Probability Density")
#dev.off()
```

Use the plot to find the following probabilities:

* What is $P(X<0.6)$?
<span style="color: red;">$P(X<0.6)= 5\times 0.05 = 0.25$</span>

* What is $P(X>0.3)$?
<span style="color: red;">$P(X>0.3)=18\times 0.05 = 0.9$</span>

* What is $P(1.5<X<1.8)$?
<span style="color: red;">$P(1.5<X<1.8)=0.05$</span>




${\bf (15)}$ Use the plot below of the probability distribution of a continuous random variable $Y$ to answer the following questions

```{r, echo=F, message=F, warning=FALSE, fig.height=6, fig.width=10}
#C:/Users/Bruin/Desktop/GS Academia/TA/Teaching STAT 251/FALL/Week_5/PMFplot2.pdf

h2 = round(1/(25*0.25), 2)
dist2 = cbind.data.frame(val = c(-1, -1, -0.75, -0.5, -0.25, 0 , 0.25, 0.5, 0.75, 1, 1), 
                        dens = c(0,  3*h2,2*h2, 6*h2,  5*h2, 5*h2,2*h2,1*h2,1*h2,0,0))
#pdf(paste0(savepath, "PMFplot2.pdf"), height = 5, width = 6.5)
ggplot(data = dist2, aes(x = val, y = dens))+geom_step(size = 1)+theme_bw()+
  scale_x_continuous(limits=c(-1, 1), breaks = seq(-1, 1, 0.25))+
  scale_y_continuous(limits=c(0,7*h2), breaks = seq(0, 7*h2, h2))+
  geom_segment(aes(xend = -1, x = 1, yend = 0, y = 0), size = 1, color = 'black')+
  theme(panel.grid.minor = element_blank(), axis.text = element_text(size = 12),
        axis.title = element_text(size = 14))+
  xlab('Y')+
  ylab("Probability Density")
#dev.off()
```


Use the plot to find the following probabilities (recall that the area of a triangle is $\frac{1}{2} \times \text{base} \times \text{height}$)


* What is $P(Y>-0.25)$?

<span style="color: red;">In this plot the area comprising a single grid square is \[ \text{Area of a rectangle} = \text{Base}\times\text{Height} = 0.25\times 0.16 \approx 0.04\] There are $13$ grid squares in the area between $-0.25$ and $1.0$ $P(Y>-0.25)=13\times 0.04 = 0.52$</span>

* What is $P(-0.5<Y<0.25)$?

<span style="color: red;">There are $16$ grid squares in the area between $-0.5$ and $0.25$ therefore $P(-0.5<Y<0.25)=16\times 0.04 = 0.64$</span>





${\bf (16)}$ Use the plot below of the probability distribution of a continuous random variable $Z$ to answer the following questions

```{r, echo=F, message=F, warning=FALSE, fig.height=6, fig.width=10}
#C:/Users/Bruin/Desktop/GS Academia/TA/Teaching STAT 251/FALL/Week_5/PMF_triangular_plot1.pdf
dist3 = cbind.data.frame(val = c(0, 2, 3, 4, 6), 
                         dens = c(0,0.3, 0.1, 0.3, 0))
#pdf(paste0(savepath, "PMF_triangular_plot1.pdf"), height = 5, width = 6.5)
ggplot(data = dist3, aes(x = val, y = dens))+geom_line(size = 1)+theme_bw()+
  scale_x_continuous(limits=c(0, 6), breaks = seq(0, 6, 1))+
  scale_y_continuous(limits=c(0,0.35), breaks = seq(0, 0.35, 0.05))+
  geom_segment(aes(xend = 0, x = 6, yend = 0, y = 0), size = 1, color = 'black')+
  theme(panel.grid.minor = element_blank(), axis.text = element_text(size = 12),
        axis.title = element_text(size = 14))+
  xlab('Z')+
  ylab("Probability Density")
#dev.off()

```

Use the plot to find the following probabilities (recall that the area of a triangle is $\frac{1}{2} \times \text{base} \times \text{height}$)


* What is $P(Z<2)$?

<span style="color: red;">$P(Z<2)=0.3$</span>

* What is $P(2<Z<3)$?

<span style="color: red;">$P(2<Z<3)=0.2$</span>

* What is $P(Z>4)$?

<span style="color: red;">$P(Z>4)=0.3$</span>

* Give the value of the $25th$ percentile of distribution of $Z$

<span style="color: red;">$Q1 = 1$</span>



${\bf 17.)}$ Assume the continuous random variable $X$ follows a normal distribution with mean $\mu = 25$ and variance $\sigma^2 = 16$. 

```{r, echo=F, message=F, warning=FALSE, fig.height=6, fig.width=10}
ggplot()+xlim(c(-40, 90))+
  stat_function(fun = dnorm, 
                args = list(mean = 25, sd = 16),
                size = 1)+
  scale_x_continuous(limits = c(-40, 90), breaks = seq(-40, 90, 20))+
  theme_classic2()+
  xlab('X')+
  ylab('Density')

```


Using a $Z$-table, find the following (approximate) probabilities for $X$. You can also use the app in the course website or [StatDistributions.com](http://www.statdistributions.com/normal/) to check your result

* What is $P(X<15)$?

<span style="color: red;">\[ z = \frac{15-25}{4} = -2.5\]
\[ P(Z<-2.5) = 0.006\]</span>

* What is $P(X>28)$?

<span style="color: red;">\[ z = \frac{28-25}{4} = 0.75\]
\[ P(Z>0.75) = 1-P(Z\leq 0.75) = 1-0.773 = 0.227\]</span>

* What is $P(12<X<20)$?

<span style="color: red;">\[ z_{\text{lower}} = \frac{12-25}{4} = -3.25\]
\[ z_{\text{upper}} = \frac{20-25}{4} = -1.25\]
\[ P(-3.25 < Z < -1.25) =   P(Z<-1.25) - P(Z<-3.25) = 0.106 - 0.001 = 0.105\]</span>

* What is $P(X>30)$?

<span style="color: red;">\[ z = \frac{30-25}{4} = 1.25\]
\[ P(Z>1.25) = 1-P(Z\leq 1.25) = 1-0.894 = 0.106 \]</span>

* What is $P(25<X<33)$?

<span style="color: red;">\[ z_{\text{lower}} = \frac{25-25}{4} = 0\]
\[ z_{\text{upper}} = \frac{33-25}{4} = 2\]
\[ P(0<Z<2) = P(Z<2) - P(Z<0) = 0.977 - 0.5 = 0.477\]</span>

* What is What value of $X$ marks the $95th$ percentile of the distribution?

<span style="color: red;">the $95th$ percentile of a standard normal distribution is $z=1.645$ plugging this into the $z$-score equation and solving for $X$ gives
\[ (z\times \sigma) + \mu = (1.645\times 4) + 25 = 31.58 \]</span>

* What is What value of $X$ marks the $40th$ percentile of the distribution?

<span style="color: red;">the $40th$ percentile of a standard normal distribution is $z=-0.253$ 
\[  (z\times \sigma) + \mu = (-0.253\times 4)+25 = 23.9 \]</span>


${\bf 18.)}$ Suppose that a random variable $X$ follows a normal distribution with mean $\mu = -5$ and standard deviation $\sigma = 1.8$. Using the plot of a the $Z$-distribution below, shade in the area corresponding to the probability $P(-2< X <0.5)$


<span style="color: red;">tart by finding the $z$-scores\[ P(-2<X<0.5) = P(X<0.5) - P(X<-2)  \]
\[ z_{\text{lower}} = \frac{0.5 - (-5)}{1.8} = 3.06\]
\[ z_{\text{upper}} = \frac{-2 - (-5)}{1.8} = 1.67\]
\[P(-2<X<0.5) = P(1.67< Z < 3.06)  \]</span>

```{r, echo=F, message=F, warning=FALSE, fig.height=6, fig.width=10}
nmean = 0
nsd = 1

d_limit <- function(x, lower, upper, mean, sd){
    y = dnorm(x, mean, sd)
    y[which(x < lower)] <- NA
    y[which(x > upper)] <- NA
    return(y)
  }

ggplot(data.frame(x = c(nmean - 4*nsd, nmean + 4*nsd)), aes(x = x))+
        stat_function(fun = d_limit,
                      args = list(lower=1.67, upper = 3.06, mean = 0, sd = 1), 
                      geom = "area", 
                      fill = "cyan3", 
                      alpha = 0.4)+
        stat_function(fun = dnorm,
                      args = list(mean = nmean, sd = nsd),
                      size = 1)+
        labs(title = paste0("Standard Normal (Z) Distribution"),
             subtitle = TeX(paste0("$Z\\sim N(\\mu = ", nmean, ', \\sigma = ',nsd, ')$')),
             x = "Z",
            y = "Probability(Z)")+
        theme_classic2()+
        theme(legend.position = 'none')
```


<br>
<br>
<br>
<br>



\newpage
\section{References}
