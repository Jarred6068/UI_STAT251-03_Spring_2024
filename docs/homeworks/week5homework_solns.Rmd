---
title: "Homework 2 Solutions"
output:
  html_document: default
  pdf_document: default
always_allow_html: true
header-includes:
  \usepackage{float}
bibliography: C:/Users/Bruin/Documents/GitHub/UI_STAT251-03_Spring_2024/docs/misc/home2bibs.bib
---




```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=12, fig.height=10, fig.pos = "H")
#knitr::opts_chunk$set(list(echo = FALSE, eval = FALSE))
library(kableExtra)
library(knitr)
library(latex2exp)
library(gridExtra)
library(ggpubr)
library(ggthemes)
library(plyr)
mainpath = 'C:/Users/Bruin/Documents/GitHub/UI_STAT251-03_Spring_2024/docs/Data/'
wmpath = 'C:/Users/Bruin/Desktop/GS Academia/MS_Stat/SEM 2/STAT 519/PROJ 1/watermelon/simulated datasets/ wawamelon/WaterMelonMaster.csv'
whiskpath = 'C:/Users/Bruin/Desktop/GS Academia/MS_Stat/SEM 2/STAT 519/PROJ 1/Whiskers/SimSealData/whiskerMaster.csv'

datapath = 'C:/Users/Bruin/Documents/GitHub/UI_STAT251-03_Spring_2024/docs/Data/'
```


$\bf (1)$ Rocket League is a popular online video game and E-sport that emerged in 2015. The game enjoys a healthy following of around 93 million players per month. The game features players from around the world who compete in sports like soccer (football), basketball and hockey while controlling RC-like vehicles. The most popular game-mode is doubles soccer in which teams of two players each try to outscore each other by hitting a soccer ball into the opposing goal. In the course of each match, the player controlled vehicles often collide in what is commonly referred to as a "bump". The following histogram shows the distribution of the average number of "bumps" per match for a given player of Rocket League 

```{r, echo=F, message=F, warning=F, fig.height=4, fig.width=8}
RL = read.table(paste0(datapath, 'RLData.txt'), sep = ',', header = T)
k = ceiling(sqrt(dim(RL)[1]))
ggplot(data = RL, aes(x = bpm))+geom_histogram(color = 'black', fill = 'lightgrey', bins = k)+
  theme_classic2()+
  scale_x_continuous(limits=round(c(min(RL$bpm), max(RL$bpm)),1), 
                     breaks = seq(round(mean(RL$bpm)-4*sd(RL$bpm),1),
                                  round(mean(RL$bpm)+4*sd(RL$bpm),1),
                                  round(sd(RL$bpm), 1)))+
  xlab('Average bumps per match')+
  theme(axis.text = element_text(size = 12),
        axis.title = element_text(size = 14))
```

(a) Assuming a mean of $\bar{x} = 355$ and standard deviation of $s = 69$, in approximately what proportion of matches did the player have more than 423 bumps?

<span style="color: red;">\[ z = \frac{423 - 355}{69} \approx 1\]. Therefore we want to know what proportion of observations have a value $\geq \bar{x}+1s$ which is by the empirical rule is $13.5\%+2.5\% = 16\%$</span>

(b) Approximately what proportion of matches did the player have more than 217 bumps but fewer than 493 bumps?

<span style="color: red;">approximately $95\%$</span>

(c) How many bumps would the player need to have in a match to be in the top $2.5\%$ of matches?

<span style="color: red;">at least $355+2s = 493$ bumps</span>


(d) After playing a new match, the player logs 620 bumps. Calculate the $z$-score for this match and explain the meaning of the z-score in relation to the average number of bumps. How many standard deviations is the player's performance from the mean number of bumps?

<span style="color: red;">\[ z = \frac{620 - 355}{69} = 3.84  \ \text{standard deviations}\] </span>

**Figure 1** Pinneped whisker morphology - Ginter et al. 2012           |  A juvenile Harp Seal
:-------------------------:|:-------------------------:
![](C:/Users/Bruin/Desktop/GS Academia/MS_Stat/SEM 2/STAT 519/PROJ 1/Proj1 presentation/whisker types.png)  |  ![](C:/Users/Bruin/Documents/GitHub/UI_STAT251-03_Spring_2024/docs/misc/Harp_seal_whitecoat.jpg)


<!-- \begin{figure} -->
<!-- \centering -->
<!--     \begin{minipage}{0.45\textwidth} -->
<!--       \includegraphics{C:/Users/Bruin/Desktop/GS Academia/MS_Stat/SEM 2/STAT 519/PROJ 1/Proj1 presentation/whisker types.png} -->
<!--       \caption{Pinneped whisker morphology - Ginter et al. 2012} -->
<!--     \end{minipage}\hfill -->
<!--     \begin{minipage}{0.45\textwidth} -->
<!--       \includegraphics{C:/Users/Bruin/Desktop/GS Academia/TA/Teaching STAT 251/FALL/Week_2/Harpseal.jpg} -->
<!--       \caption{A juvenile Harp Seal} -->
<!--     \end{minipage} -->
<!-- \end{figure} -->
```{r, echo=FALSE, message=FALSE, warning=FALSE}
whiskers = read.csv(whiskpath)
teach = read.csv(paste0(mainpath, 'teacher_salary.csv'))
ga = read.csv(paste0(mainpath, 'georgia_student_survey.csv'))

```


$\bf (2)$
Pinnipeds (seals and sea lions) possess the largest vibrissae (whiskers) among mammals and their vibrissal hair shafts demonstrate a diversity of shapes (**See Figure 1**). In a study conducted by [@ginter2012fused], researchers measured 9 characteristics of Pinniped whiskers in individuals from 9 species of seals and sea lion. Their goal was to better characterize whisker morphology and evolution. The following data are the recorded whisker lengths of 20 Harp Seals (given in **Table 1**). Note that the data have been sorted according to increasing ``Total Length (cm)" for your convenience - use the table to answer the following questions:


\newpage



```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.height=4, fig.width=8}
set.seed(323)
sel = c(76,53,40,29,73,5,77,32,45,74,56,24,6,19,37,26,43,34,33,28)#58,49,25,38,1,18,78,48,75,42,8,31,59,80,47,46,67,64,16,27)
FS = subset(whiskers, species.name == 'Harp')[sel,7:8]
FS$num.beads = round(FS$num.beads)
FS[10,]=c(5.08, 3)

ix = sort(FS$total.length, index.return = T)$ix

kable(cbind.data.frame(c(1:20), FS[ix,]), format = 'html', booktabs = T, escape = F, 
      col.names = c("Observation","Whisker Total Length (cm)", "Number of Beads"), digits = 2,
      row.names = F, caption = 'Whisker Length data for $n = 20$ Harp Seals')%>%
  kable_classic(full_width = F, html_font = "Cambria")%>%kable_styling(bootstrap_options = 'striped')

print(paste0('comma separated values = ', paste0(round(FS[ix,]$total.length,2), collapse = ',')))
```



\newpage

(a) Compute the quartiles, interquartile range, mean, and standard deviation for the variable ``Total Length (cm)" - (use the course website apps for help)

<span style="color: red;">\begin{eqnarray} Q1 = \frac{4.33+4.34}{2} = 4.335 \approx 4.34 \\\nonumber
 median =  \frac{4.41+4.43}{2} = 4.42 \\\nonumber
 Q3 = \frac{4.48+4.51}{2} = 4.49 \\\nonumber
 IQR =  4.49 - 4.34 = 0.15 \\\nonumber
 \bar{x} =  \sum_{i = 1}^{20} \frac{4.18 + 4.23 + \cdots 5.08}{20} = 4.446 \\\nonumber
 s =  \sqrt{\sum_{i = 1}^{20}\frac{(4.18 - 4.45)^2 + (4.23 - 4.45)^2 + \cdots (5.08 - 4.45)^2}{19}} = 0.189 \\\nonumber
\end{eqnarray}</span>

(b) Make a boxplot of the variable ``Total Length" and make note of any outliers

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.height=5, fig.width=10}
X = FS[ix,]$total.length
estims = rep(0, 6)
boxplot(X, horizontal = TRUE, axes = TRUE, staplewex = 1)
estims[1:5] = as.numeric(round(summary(X)[c(1:3, 5:6)],2))
estims[3]= estims[3]
estims[5]= round(X[length(X)-1],2)
estims[6]= round(max(X),2)

locals = estims
#locals[3] = locals[3]+0.005
locals[1] = locals[1]+0.02
locals[2] = locals[2]-0.01
locals[4] = locals[4]+0.01
locals[6] = locals[6]-0.05
text(x=locals, labels =paste(c("Min", "Q1","Median", "Q3", "Max", "Outlier"), 
                            estims, sep = "="), y=1.25, cex = 0.8)
text(x=locals[3], labels =paste("IQR", round(estims[4] - estims[2],2), sep = " = "), y=1.3, 
     cex = 1)
```


(c) Observation 20 has a total whisker length of 5.08 (cm), how many standard deviations is this observation from the mean whisker length? (hint compute the $z$-score for this observation)

<span style="color: red;">The sample mean is $\bar{x} = 4.446$ and the sample standard deviation is $s = 0.189$ 
\[ z = \frac{5.08 - \bar{x}}{s} = \frac{5.080 - 4.446}{0.189} = 3.372  \]</span>



$\bf (3)$
Use the following pair of boxplots constructed from the Pinneped whisker data in $\textbf{Table 1}$. The boxplots show the distribution of total whisker length (cm) for whiskers with 2 beads vs whiskers with three beads. Answer the following questions:

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.height=4, fig.width=8}
FS$num.beads = as.factor(FS$num.beads)

bead3 = subset(FS, num.beads == 3)
bead2 = subset(FS, num.beads == 2)



A = ggplot(data=FS, aes(x = total.length, fill = num.beads))+
  theme_classic()+
  geom_boxplot(outlier.fill = 'red', outlier.color = 'black', alpha = 0.8,
               size = 1, outlier.size = 5,
               outlier.shape = 21)+
  geom_text(aes(x = max(bead3$total.length), y = 0.25), label = 'x = 5.08')+
  geom_text(aes(x = mean(bead3$total.length), y = 0.45), label = TeX('$\\bar{x}_{3 beads} = 4.61$'))+
  geom_text(aes(x = mean(bead2$total.length), y = 0.05), label = TeX('$\\bar{x}_{2 beads} = 4.39$'))+
  geom_text(aes(x = mean(bead3$total.length), y = 0.4), label = TeX('$s_{3 beads} = 0.27$'))+
  geom_text(aes(x = mean(bead2$total.length), y = 0.1), label = TeX('$s_{2 beads} = 0.12$'))+
  theme(axis.text.x = element_text(size = 12),
        axis.text.y = element_blank(),
        axis.title.y = element_text(size = 12),
        axis.title.x = element_text(size = 12),
        legend.text = element_text(size = 12),
        legend.position = 'top')+
  xlab('Whisker Total Length (cm)')+
  guides(fill=guide_legend(title="Number of Beads"))

plot(A)
#ggarrange(A, B, nrow = 2)

print('-----------------2 bead whisker lengths-----------------')
paste('comma separated values = ', paste0(round(bead2$total.length, 1), collapse = ','))
print('-----------------3 bead whisker lengths-----------------')
paste('comma separated values = ', paste0(round(bead3$total.length, 1), collapse = ','))
```

(a) Using the boxplot above, do the whisker lengths for 2 bead and 3 bead whiskers follow a normal distribution? why or why not? 

<span style="color: red;">The distribution for 3 beads is normally distributed (given by the symmetry of boxplot) but the distribution for two beads is skewed</span>

(b) Suppose researchers observe two new Harp Seals (Denoted Seal 1 and Seal 2) and record their total whiskers lengths and the number of beads on the whiskers. Seal 1 has a total whisker length of 4.32 (cm) and the whisker has 3 beads. Seal 2 has a total whisker length of 4.34 (cm) but the whisker has only 2 beads. Suppose we want to know how they compare <i>relative</i> to the distribution of whiskers with the same number of beads. Confirm that the whisker length of seal 1 has a $z$-score of $-1.07$ while Seal 2 has a $z$-score of $-0.43$. Refer to the boxplot above

<span style="color: red;">The mean length for whiskers with two beads and three beads is $\bar{x}_{2beads} = 4.32$ and $\bar{x}_{3beads} = 4.61$ respectively. The standard deviation in length for whiskers with 2 and 3 beads is $s_{2beads} = 0.121$ and $s_{3beads} = 0.270$ respectively. Seal 1 has a $z$-score of 
\[z_1 = \frac{4.32 - \bar{x_3}}{s_3} = \frac{4.32 - 4.61}{0.27} = -1.07\]
And Seal 2 has a $z$-score of
\[z_2 = \frac{4.34 - \bar{x_2}}{s_2} = \frac{4.34 - 4.39}{0.12} = -0.43\] </span>

(c) If the researchers were to observe the whisker length of a new seal and the whisker had 3 beads, how long or short would the whisker of this observation have to be for it to be considered an outlier? (assume the data is approximately normal)

<span style="color: red;">Since the data is approximately symmetric (normal) we can use the 2 standard deviations rule $\bar{x}-2s > x > \bar{x}+2s$ - the whisker would have to be greater than
\[ \bar{x}_3 + 2s = 4.608 + 2\times 0.270 = 5.148 (cm) \]
or less than 
\[ \bar{x}_3 - 2s = 4.608 - 2\times 0.270 = 4.068 (cm)\]</span>





$\bf (4)$
Use the following plot of the cumulative distribution of a quantitative variable $x$ to answer questions (a)-(c)

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.height=5, fig.width=8}

#set.seed(555)
#x = sort(round(rnorm(50, 5, 4), 1))

x = c(-4.7,-2.5,-2.3,-1.3,-1.3,-1.2,0.0,0.0,1.0,1.8,2.1, 2.3, 2.6, 2.8, 2.8, 2.9, 3.5, 3.6, 3.7, 3.7, 4.3, 4.8, 4.9, 5.2, 5.3, 5.5, 6.0, 6.5, 6.6, 7.1, 7.1, 7.2, 7.4, 7.7, 7.8, 8.1, 8.1, 8.1, 8.5, 8.7, 9.0, 9.0, 10.0, 10.2, 10.2, 11.0, 11.0, 11.1, 11.1, 11.5)
xg = unique(x)
crfxg = cumsum(summary(as.factor(x))/sum(summary(as.factor(x))))
dat = cbind.data.frame(x = xg, `CRF(x)` = crfxg)

B = ggplot(dat, aes(x = x, y = `CRF(x)`))+geom_step()+
  geom_point(size = 3)+
  theme_hc()+
  scale_y_continuous(breaks = seq(0, 1, 0.1))+
  scale_x_continuous(breaks = seq(min(dat$x), max(dat$x), 1))
plot(B)

paste('Comma separated values = ', paste0(x, collapse = ','))
```


(a) Assume that the mean and standard deviation of $X$ are $\bar{x} = 5$ and $s = 4$. Use these values to find the $2.5th$ and $97.5th$ percentiles of $X$ (hint: think about shape and how that relates to the empirical rule).

<span style="color: red;">approximately -7 and 17. Using the plot above the answers are approximately -2.5 and 11.1. The upper percentile differs because the distribution of $X$ is skewed to the left. The percentiles given by the empirical rule are only approximate for distributions with slight deviations from normality/span>

(b) Assume the above cumulative distribution represents an approximately normal distribution (symmetric, bell-shaped) with a standard deviation of $s = 4$ and a mean of $\bar{x} = 5$, Under the empirical rule, what percentage of the observations will have a value between $-7$ and $17$?

<span style="color: red;">if the mean is $\bar{x} = 5$ then both $-3$ and $13$ are two standard deviations from the mean e.g $-7 = \bar{x}-3s$ and $17 = \bar{x}+3s$. Under the empirical rule, appoximately $99.7\%$ data will fall in this interval </span>

(c) Using the mean and standard deviation from part <i>a-b</i>, compute and interpret the z-scores for the observations $x_1 = 11.5$ and $x_2 = -4.7$. Would these two observations be considered outliers under the $\pm 2s$ rule?

<span style="color: red;">
\[ z_1 = \frac{11.5 - 5}{4} \approx 1.63 \]
</span>
<span style="color: red;">
\[ z_2 = \frac{-4.7 - 5}{4} \approx -2.43 \]
</span>




$\bf (5)$
Define the following terms

(a) Explanatory variable - <span style="color: red;">The independent variable which we manipulate to see how the response variable changes</span>

(b) Response variable - <span style="color: red;">The outcome or dependent variable - the variable on which we make comparisons for different values of the explanatory variable </span>

(c) experimental study - <span style="color: red;">A study which assigns subjects/observations to one or more treatments and observes the outcome of the response variable </span>

(d) observational study - <span style="color: red;">A nonexperimental study in which the researcher observes values of the response and explanatory variables for each subject/observation</span>

(e) survey - <span style="color: red;">A type of nonexperimental study in which subjects/observations are selected from a population for the purpose of making inferences about the population.</span>


$\bf (6)$ 
Name the sampling method used in each of the following situations: 


(a) A man is standing outside of a grocery store handing out questionnaires to shoppers asking them to evaluate their shopping experience and the quality of service. He does not ask shoppers who have their hands full carrying groceries, but instead asks all shoppers who have only a few items or have both hands free to fill out the questionnaire.

<span style="color: red;">convienence sampling</span>

(b) A gardener has garden box in which he has planted 10 rows of corn. Each row consists of eight corn plants. The gardener wishes to know the average height of the corn plants in the garden box so he randomly selects rows 1, 5, and 9 and measures the height of all corn plants in those rows.

<span style="color: red;">cluster sampling</span>

(c) A company wishes to know how employees feel about compensation and benefits. Over the next few weeks, the company asks 30 employees from each of its branch locations to fill out a survey regarding compensation. 

<span style="color: red;">stratified random sampling</span>


(d) A local polling company wishes to know what proportion of citizens in Moscow, Idaho are voting for the republican candidate in mayoral race. The polling company records this information for every 5th voter who leaves the voting booth.

<span style="color: red;">systematic sampling</span>


(e) A lumber company wishes to estimate the amount of usable lumber on a plot of land. The company randomly selects 100 trees and measures their diameter, height, and volume, in order to estimate the number of board feet of each tree. 

<span style="color: red;">simple random sampling</span>



\newpage
# References 









































\newpage
\section{References}
